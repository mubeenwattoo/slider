<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v6.0.0-beta3/css/all.css" />
  <title>Slider â€” Images + Self-hosted Videos (Demo sources)</title>
  <style>
    :root {
      --frame-w: min(78vw, 1160px);
      --aspect: 16/9;
      --pad: clamp(14px, 2vw, 28px);
      --gap: clamp(16px, 2.4vw, 32px);
      --frame-bg: #eeeeee;
      --arrow-bg: #111;
      /* pill bg */
      --arrow-pill-w: 110px;
      --arrow-pill-h: 50px;
      --arrow-shadow: 0 8px 24px rgba(0, 0, 0, .25);
      --radius: 14px;
      --speed: 520ms;
      --tease: 22px;
    }

    * {
      box-sizing: border-box
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif
    }

    .slider {
      position: relative;
      height: clamp(300px, 56vw, 640px);
      display: grid;
      place-items: center;
      overflow: hidden;
      touch-action: pan-y
    }

    .slider__frame {
      position: absolute;
      width: var(--frame-w);
      aspect-ratio: var(--aspect);
      background: var(--frame-bg);
      z-index: 1;
      pointer-events: none
    }

    .slider__viewport {
      position: relative;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: 2;
      touch-action: pan-y
    }

    .slider__track {
      position: absolute;
      top: 50%;
      left: 0;
      display: flex;
      gap: var(--gap);
      transform: translate3d(0, -50%, 0);
      transition: transform var(--speed) cubic-bezier(.22, .61, .36, 1);
      will-change: transform;
      list-style: none;
      margin: 0;
      padding: 0;
      touch-action: none
    }

    .slide {
      list-style: none;
      flex: 0 0 auto;
      width: calc(var(--frame-w) - (var(--pad) * 2));
      aspect-ratio: var(--aspect);
      padding: var(--pad);
      background: transparent
    }

    .media {
      position: relative;
      width: 100%;
      height: 100%;
      border-radius: var(--radius);
      overflow: hidden;
      background: transparent;
      transition: transform 200ms ease
    }

    .media img,
    .media video {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      border: 0
    }

    .media video {
      background: #000
    }

    .touch-layer {
      position: absolute;
      inset: 0;
      z-index: 3;
      background: transparent;
      pointer-events: none
    }

    @media (max-width:767px) {
      .touch-layer {
        pointer-events: auto;
        touch-action: none
      }
    }

    .nav {
      position: absolute;
      left: 0;
      top: 0;
      transform: translate(-50%, -50%);
      width: var(--arrow-pill-w);
      height: var(--arrow-pill-h);
      border: 0;
      border-radius: 9999px;
      background: var(--arrow-bg);
      box-shadow: var(--arrow-shadow);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 140ms ease, transform 140ms ease;
      z-index: 5;
      cursor: pointer;
      user-select: none;
    }

    .nav:hover {
      transform: translate(-50%, -50%) scale(1.05)
    }

    @media (max-width:767px) {
      .nav {
        display: none !important
      }

      :root {
        --frame-w: 92vw;
        --pad: 12px;
        --gap: 16px
      }

      .media {
        transition: none
      }
    }

    @media (prefers-reduced-motion:reduce) {
      .slider__track {
        transition: transform 200ms linear
      }
    }
  </style>
</head>

<body>

  <section class="slider" data-images="https://picsum.photos/id/1015/1600/900,https://picsum.photos/id/1035/1600/900"
    data-videos="https://media.w3.org/2010/05/sintel/trailer.mp4,https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4">
    <div class="slider__frame" aria-hidden="true"></div>
    <div class="slider__viewport">
      <ul class="slider__track"></ul>
    </div>
    <button class="nav nav--left" type="button" aria-label="Previous">
      <i class="fa-light fa-arrow-left-long arrow-icon" style="color: #3c95ff; font-size: 48px;"></i>

    </button>
    <button class="nav nav--right" type="button" aria-label="Next">
      <i class="fa-light fa-arrow-right-long arrow-icon" style="color: #3c95ff; font-size: 48px;"></i>
    </button>
  </section>



  <script>
    (function () {
      document.querySelectorAll('.slider').forEach(initSlider);

      function initSlider(root) {
        const frame = root.querySelector('.slider__frame');
        const track = root.querySelector('.slider__track');
        const prevB = root.querySelector('.nav--left');
        const nextB = root.querySelector('.nav--right');

        const images = (root.dataset.images || '').split(',').map(s => s.trim()).filter(Boolean);
        const videos = (root.dataset.videos || '').split(',').map(s => s.trim()).filter(Boolean);
        let items = [];
        images.forEach(u => items.push({ t: 'img', u }));
        videos.forEach(u => items.push({ t: 'vid', u }));
        if (items.length === 0) { items = Array.from({ length: 3 }, (_, i) => ({ t: 'img', u: `https://picsum.photos/seed/ph-${i}/1600/900` })); }

        const slideHTML = (it) => it.t === 'img'
          ? `<li class="slide"><div class="media"><img src="${it.u}" alt="Slide image"><div class="touch-layer" aria-hidden="true"></div></div></li>`
          : `<li class="slide"><div class="media"><video src="${it.u}" muted playsinline autoplay loop preload="metadata" crossorigin="anonymous"></video><div class="touch-layer" aria-hidden="true"></div></div></li>`;

        track.insertAdjacentHTML('beforeend', slideHTML(items.at(-1)));
        items.forEach(it => track.insertAdjacentHTML('beforeend', slideHTML(it)));
        track.insertAdjacentHTML('beforeend', slideHTML(items[0]));

        const slides = Array.from(track.children);
        const N = items.length;
        let vIdx = 1;   // real index (1..N)
        let domIdx = 1; // centered DOM index (0..N+1 when animating to clones)

        const geom = () => {
          const rRoot = root.getBoundingClientRect();
          const rFrame = frame.getBoundingClientRect();
          const base = (rFrame.left - rRoot.left) + (rFrame.width - slides[1].getBoundingClientRect().width) / 2;
          return { base, rRoot };
        };

        function centerDom(idx, animate = true) {
          domIdx = idx;
          const { base } = geom();
          const x = base - slides[idx].offsetLeft;
          if (!animate) {
            track.style.transition = 'none';
            track.style.transform = `translate3d(${x}px,-50%,0)`;
            void track.offsetHeight; track.style.transition = '';
            return;
          }
          track.style.transform = `translate3d(${x}px,-50%,0)`;
        }

        function centerVirtual(dir = 0) {
          let target = vIdx;
          if (dir === +1 && domIdx === N) target = N + 1;     // to right clone
          else if (dir === -1 && domIdx === 1) target = 0;  // to left clone
          centerDom(target, true);
          syncPlayback();
        }

        track.addEventListener('transitionend', (e) => {
          if (e.target !== track || e.propertyName !== 'transform') return;
          if (domIdx === 0) { vIdx = N; centerDom(N, false); }
          else if (domIdx === N + 1) { vIdx = 1; centerDom(1, false); }
          syncPlayback();
        });

        function syncPlayback() {
          slides.forEach((li, i) => {
            const v = li.querySelector('video');
            if (!v) return;
            if (i === domIdx) v.play().catch(() => { });
            else v.pause();
          });
        }

        function step(dir) {
          vIdx += dir; if (vIdx > N) vIdx = 1; if (vIdx < 1) vIdx = N;
          centerVirtual(dir);
        }

        /* desktop arrows + tease */
        function clearTease() { slides.forEach(li => { const m = li.querySelector('.media'); if (m) m.style.transform = ''; }); }
        function tease(side) {
          if (window.matchMedia('(max-width:767px)').matches) return;
          clearTease();
          if (side === 'right') {
            slides[Math.min(domIdx + 1, slides.length - 1)]?.querySelector('.media')?.style.setProperty('transform', 'translateX(calc(-1 * var(--tease)))');
          } else {
            slides[Math.max(domIdx - 1, 0)]?.querySelector('.media')?.style.setProperty('transform', 'translateX(var(--tease))');
          }
        }
        root.addEventListener('mousemove', (e) => {
          if (window.matchMedia('(max-width:767px)').matches) return;
          const { rRoot } = geom();
          const media = slides[domIdx].querySelector('.media');
          const rm = media.getBoundingClientRect();
          const cx = e.clientX, cy = e.clientY;
          const beyondRight = cx > rm.right, beyondLeft = cx < rm.left;
          const xRel = Math.max(rRoot.left, Math.min(rRoot.right, cx)) - rRoot.left;
          const yRel = Math.max(rRoot.top, Math.min(rRoot.bottom, cy)) - rRoot.top;
          const show = (btn, x, y) => { btn.style.left = x + 'px'; btn.style.top = y + 'px'; btn.style.opacity = '1'; };
          const hide = (btn) => { btn.style.opacity = '0'; };
          if (beyondRight) { show(nextB, xRel, yRel); hide(prevB); tease('right'); }
          else if (beyondLeft) { show(prevB, xRel, yRel); hide(nextB); tease('left'); }
          else { hide(prevB); hide(nextB); clearTease(); }
        });
        root.addEventListener('mouseleave', () => { prevB.style.opacity = '0'; nextB.style.opacity = '0'; clearTease(); });
        nextB.addEventListener('click', e => { e.stopPropagation(); step(+1); });
        prevB.addEventListener('click', e => { e.stopPropagation(); step(-1); });

        /* drag / swipe */
        let startX = 0, startTx = 0, drag = false;
        const isNav = t => !!t.closest?.('.nav');
        root.addEventListener('pointerdown', e => {
          if (isNav(e.target)) return;
          drag = true; root.setPointerCapture?.(e.pointerId);
          startX = e.clientX;
          const m = /matrix\(1, 0, 0, 1, (-?\d+(\.\d+)?),/.exec(getComputedStyle(track).transform);
          startTx = m ? parseFloat(m[1]) : 0;
          track.style.transition = 'none'; clearTease();
        }, { passive: true });
        root.addEventListener('pointermove', e => {
          if (!drag) return;
          const dx = e.clientX - startX;
          track.style.transform = `translate3d(${startTx + dx}px,-50%,0)`;
        }, { passive: true });
        const endDrag = () => {
          if (!drag) return; drag = false; track.style.transition = '';
          const { base } = geom();
          const m = /matrix\(1, 0, 0, 1, (-?\d+(\.\d+)?),/.exec(getComputedStyle(track).transform);
          const tx = m ? parseFloat(m[1]) : 0;
          let best = domIdx, bestErr = Infinity;
          for (let i = 0; i < slides.length; i++) {
            const left = slides[i].offsetLeft;
            const err = Math.abs(base - left - tx);
            if (err < bestErr) { bestErr = err; best = i; }
          }
          centerDom(best, true);
          if (best === 0) vIdx = N; else if (best === N + 1) vIdx = 1; else vIdx = best;
          syncPlayback();
        };
        root.addEventListener('pointerup', endDrag, { passive: true });
        root.addEventListener('pointercancel', endDrag, { passive: true });

        /* keep centered on resize/orientation per instance */
        const recenter = () => centerDom(domIdx, false);
        window.addEventListener('resize', recenter);
        window.addEventListener('orientationchange', recenter);
        new ResizeObserver(recenter).observe(root);

        requestAnimationFrame(() => { centerDom(vIdx, false); syncPlayback(); });
      }
    })();
  </script>
</body>

</html>